name: Printar Valores da Issue

on:
  issues:
    types: [opened]
  workflow_dispatch:
    inputs:
      issue_number:
        description: "NÃºmero da Issue utilizada"
        type: number

jobs:
  get-issue-number:
    runs-on: ubuntu-latest
    outputs:
      payload: ${{ steps.parse.outputs.payload }}
    steps:
      - name: Parse issue
        id: parse
        uses: onmax/issue-form-parser@v1.4
        with:
          issue_number: ${{ github.event.issue.number }}

      - name: Show parsed payload data
        run: |
          echo "${{ steps.parse.outputs.payload }}"

          rg_name=$(echo "${{ steps.parse.outputs.payload }}" | jq -r '.sections[]' | sed -n '1p')
          sa_name=$(echo "${{ steps.parse.outputs.payload }}" | jq -r '.sections[]' | sed -n '2p')

          echo "Resource Group Name: $rg_name"
          echo "Storage Account Name: $sa_name"

          echo "::set-output name=rg_name::$rg_name"
          echo "::set-output name=sa_name::$sa_name"
